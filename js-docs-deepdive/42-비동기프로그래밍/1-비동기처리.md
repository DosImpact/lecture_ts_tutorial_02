## 42.1 동기 처리와 비동기 처리

함수 실행 시 일어나는 일

- 함수 실행 컨텍스트가 생성
- 실행 컨텍스트 스택에 푸시
- 함수 코드가 실행된다.
- 실행 컨텍스트 스택에서 팝되어 제거

JS 엔진은 하나의 실행 컨텍스트만을 갖는다.

- 동시에 두개의 함수를 실행할 수는 없다.
- 싱글 스레드 기반으로 동작하기 때문
- 실행중인 태스크가 종료될때까지 기다리는 방식을 **동기처리**
- 장점 : 실행순서가 보장, 단점 : 블록킹

- 비동기처리 : 현재 실행중인 태스크가 종료되지 않더라도 다음 태스크를 곧바로 실행한다.
- 대표적인 타이머 함수 setTimeout, setInterval, HTTP요청, 이벤트 핸들러는 비동기이며, 이는 이벤트 루프와 태스크 큐에 기반한다.

## 42.2 이벤트 루프 , 태스크 큐

이벤트 루프

- JS의 동시성을 지원하기 위함
- 브라우저에 내장되어 있는 기능이다.

1. 크롬 V8 JS 엔진을 비롯한 JS엔진의 구성

- 콜스택 + 힙 영역으로 구성
- 콜스택 : 스택자료구조로, 실행컨텍스트 스택이 콜스택이다.
- 힙 영역 : 객체가 저장되는 메모리 공간
  - 실행컨텍스트가 힙에 저장된 객체를 참조한다.
  - 메모리 공간이 동적할당 되므로, 힙은 구조화되지 않은 상태라는것이 특징
- JS엔진은 함수의 평가와 실행을 담당할뿐, 호출 스케쥴링은 브라우저(Node.js)가 담당한다.

2. 브라우저(Node.js)

- 테스크 큐 + 이벤트 루프로 구성
- 테스크 큐 : 비동기함수의 콜백, 이벤트핸들러가 일시적으로 보관되는 큐 영역
- 이벤트 루프 : 콜스택을 관찰, 태스크 큐에 대기중인 함수를 확인

* 콜스택이 비어있고 && 테스크 큐에 대기중인 함수가 있다면
* FIFO 방식으로 함수를 콜스택으로 이동

- JS엔진이 싱글 스레드 , 브라우저는 멀티 스레드로 동작
- 예를들어, 작업 1. JS엔진이 콜스택함수를 실행&평가 하는 작업(JS엔진)
- 작업 2. timer관련 함수가 시간이 되면 콜스택으로 푸시(브라우저)
- 작업 1,2 가 동시에 실행된다. (병행 처리)
